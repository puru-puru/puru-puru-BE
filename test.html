<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>회원가입 및 이메일 인증 테스트</title>
</head>
<body>
  <h2>회원가입 및 이메일 인증 테스트</h2>
  <form id="signupForm">
    <label for="email">이메일:</label>
    <input type="email" id="email" name="email" required>
    <button type="button" onclick="requestEmailVerification()">이메일 인증</button>
    <br>
    <label for="verificationCode">인증 코드:</label>
    <input type="text" id="verificationCode" name="verificationCode" required>
    <button type="button" onclick="verifyEmail()">인증 확인</button>
    <br>
    <label for="password">비밀번호:</label>
    <input type="password" id="password" name="password" required>
    <br>
    <label for="confirmPassword">비밀번호 확인:</label>
    <input type="password" id="confirmPassword" name="confirmPassword" required>
    <br>
    <button type="button" onclick="signup()">회원가입</button>
  </form>

  <script>
    async function requestEmailVerification() {
      const email = document.getElementById('email').value;

      try {
        // 이메일 인증 메일 요청
        const emailVerificationResponse = await fetch('http://localhost:3000/api/auth/request-email-verification', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            email,
          }),
        });

        const emailVerificationData = await emailVerificationResponse.json();

        // 출력 결과 확인
        console.log('Email Verification Response:', emailVerificationData);

      } catch (error) {
        console.error('Error:', error);
      }
    }

    async function verifyEmail() {
      const email = document.getElementById('email').value;
      const verificationCode = document.getElementById('verificationCode').value;

      try {
        // 이메일 인증 확인 요청
        const verifyEmailResponse = await fetch(`http://localhost:3000/api/auth/verify-email?email=${email}&verificationCode=${verificationCode}`, {
          method: 'GET',
        });

        const verifyEmailData = await verifyEmailResponse.json();

        // 출력 결과 확인
        console.log('Verify Email Response:', verifyEmailData);

      } catch (error) {
        console.error('Error:', error);
      }
    }

    async function signup() {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;

      try {
        // 회원가입 요청
        const signupResponse = await fetch('http://localhost:3000/api/auth/sign-up', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            email,
            password,
            confirmPassword,
          }),
        });

        const signupData = await signupResponse.json();

        // 출력 결과 확인
        console.log('Signup Response:', signupData);

      } catch (error) {
        console.error('Error:', error);
      }
    }
  </script>
</body>
</html>
